"use strict";var _classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}(),BoardManager=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"tryGetCell",value:function(e,n,r){return this.isValidMove(e,n)?r.rows[n][e]:null}},{key:"isValidMove",value:function(e,n){return e>-1&&n>-1&&8>e&&8>n}}]),e}();
"use strict";var _classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Repository=function(){function e(){_classCallCheck(this,e),this.snapshots=[]}return _createClass(e,[{key:"recordMove",value:function(e){var t=this.getSnapshotPattern(e.gameBoard);console.log("Snapshot created: ",t),this.snapshots.push(t),e.snapShots=this.snapshots,console.log("Saving Data: ",e)}},{key:"getSnapshotPattern",value:function(e){return e.moves.reduce(function(e,t){return e+(""+t.x+"-"+t.y+"-"+t.player+"-"+(+t.wasHighestScoring||0)+",")},"")}}]),e}();
"use strict";var _classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),ScoreKeeper=function(){function e(t){_classCallCheck(this,e),this.boardManager=t}return _createClass(e,[{key:"playerHasNextMove",value:function(e,t){var r=this;return r.getEmptyCells(t).forEach(function(t){return r.setScoreForMove(t.col,t.row,e)>0?!0:void 0}),!1}},{key:"setScoreForMove",value:function(e,t,r,n){var a=this,o=[],i=["Up","UpAndRight","Right","DownAndRight","Down","DownAndLeft","Left","UpAndLeft"];return i.forEach(function(i){o=o.concat(a["search"+i](e,t,r,n))}),o}},{key:"getFlatGameBoard",value:function(e){return Array.prototype.concat.apply([],e.rows)}},{key:"getEmptyCells",value:function(e){return this.getFlatGameBoard(e).filter(function(e){return 0===e.player})}},{key:"calculatePoints",value:function(e,t,r,n,a){function o(e,o){for(var u=!0;u;){h=f=void 0,u=!1;var l=e,s=o;if(null===c.boardManager.tryGetCell(s,l,a))return[];var h=a.rows[l][s],f=c.checkCell(h,n);if(!f.isValidMove||f.isEmpty)return[];if(!f.isPoint)return i;i.push(h),e=l+t,o=s+r,u=!0}}var i=[],c=this;return o(e.row,e.col)}},{key:"checkCell",value:function(e,t){var r=this.boardManager.isValidMove(e.col,e.row),n=r?0===e.player:!1,a=r?e.player!==t&&!n:!1;return{isValidMove:r,isEmpty:n,isPoint:a}}},{key:"getScoreForPlayer",value:function(e,t){return this.getFlatGameBoard(t).reduce(function(t,r){return r.player===e&&t++,t},0)}},{key:"resetMoveScoreRatings",value:function(e){return this.getFlatGameBoard(e).forEach(function(e){e.isHighestScoring=!1}),e}},{key:"searchRight",value:function(e,t,r,n){return this.searchAt(e,t,0,1,r,n)}},{key:"searchLeft",value:function(e,t,r,n){return this.searchAt(e,t,0,-1,r,n)}},{key:"searchUp",value:function(e,t,r,n){return this.searchAt(e,t,-1,0,r,n)}},{key:"searchDown",value:function(e,t,r,n){return this.searchAt(e,t,1,0,r,n)}},{key:"searchUpAndRight",value:function(e,t,r,n){return this.searchAt(e,t,-1,1,r,n)}},{key:"searchUpAndLeft",value:function(e,t,r,n){return this.searchAt(e,t,-1,-1,r,n)}},{key:"searchDownAndRight",value:function(e,t,r,n){return this.searchAt(e,t,1,1,r,n)}},{key:"searchDownAndLeft",value:function(e,t,r,n){return this.searchAt(e,t,1,-1,r,n)}},{key:"searchAt",value:function(e,t,r,n,a,o){var i=this.boardManager.tryGetCell(e+n,t+r,o);return null!==i?this.calculatePoints(i,r,n,a,o):[]}}]),e}();
"use strict";var _classCallCheck=function(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")},Player=function s(t){_classCallCheck(this,s),this.number=t,this.score=2,this.moves=[]},Move=function t(s,i,a,h,l){_classCallCheck(this,t),this.x=i,this.y=s,this.pointValue=a,this.player=h,this.time=0,this.timeInMatch=0,this.wasHighestScoring=l},Cell=function i(s,t){_classCallCheck(this,i),this.row=s,this.col=t,this.player=0,this.potentialTarget=!1};
"use strict";var _slicedToArray=function(r,e){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r)){var o=[],t=!0,a=!1,n=void 0;try{for(var l,i=r[Symbol.iterator]();!(t=(l=i.next()).done)&&(o.push(l.value),!e||o.length!==e);t=!0);}catch(c){a=!0,n=c}finally{try{!t&&i["return"]&&i["return"]()}finally{if(a)throw n}}return o}throw new TypeError("Invalid attempt to destructure non-iterable instance")};!function(){function r(){var r="";c.rows.forEach(function(e,o){e.forEach(function(e,t){r+="<div class='cell' data-target=\""+e.potentialTarget+'" data-is-highest-scoring-move="'+e.isHighestScoring+'" data-player-num="'+e.player+"\" data-row-num='"+o+"' data-col-num='"+t+"'>"+e.player+"</div>"})}),$(".game-board").html(r)}function e(){var r=f.getFlatGameBoard(c);r.forEach(function(r){r.potentialTarget=!1});var e=r.filter(function(r){return r.player===v.number}),o=[];return e.forEach(function(r){var e=d.tryGetCell(r.col,r.row-1,c);t(e,o);var a=d.tryGetCell(r.col+1,r.row-1,c);t(a,o);var n=d.tryGetCell(r.col-1,r.row-1,c);t(n,o);var l=d.tryGetCell(r.col-1,r.row,c);t(l,o);var i=d.tryGetCell(r.col+1,r.row,c);t(i,o);var s=d.tryGetCell(r.col,r.row+1,c);t(s,o);var u=d.tryGetCell(r.col+1,r.row+1,c);t(u,o);var v=d.tryGetCell(r.col-1,r.row+1,c);t(v,o)}),o}function o(r){var e=i(),o=_slicedToArray(e,2),t=(o[0],o[1]),a=f.setScoreForMove(r.col,r.row,t,c),n=a.length,l=0===r.player&&n>0;return{isHit:l,points:n}}function t(r,e){if(null!==r){var t=o(r);t.isHit&&(r.potentialTarget=!0,r.pointValue=t.points,-1===e.indexOf(r)&&e.push(r))}}function a(r){var e=1===r?0:1;v=y[e]}function n(r){r.forEach(function(r){var e=$(".player-"+r.number);r.score=f.getScoreForPlayer(r.number,c),$(".player-"+r.number+" .score").html(r.score),$(".player-"+r.number+" .moves").html(r.moves.length),r.number===v.number?e.addClass("active"):e.removeClass("active")})}function l(){c.rows[3][3].player=1,c.rows[4][3].player=2,c.rows[3][4].player=2,c.rows[4][4].player=1;var r=[c.rows[2][4],c.rows[3][5],c.rows[4][2],c.rows[5][3]];r.forEach(function(r){r.potentialTarget=!0})}function i(){var r=1===v.number?1:0;return[v.number,y[r].number]}for(var c={rows:[],moves:[]},s=new Player(1),u=new Player(2),v=s,y=[s,u],f=void 0,m=!1,p=new Date,w=new Repository,d=new BoardManager,g=new Date,h=8,b=8,C=0;h>C;C++){for(var E=[],G=0;b>G;G++)E.push(new Cell(C,G));c.rows.push(E)}f=new ScoreKeeper(d);var S=function(r,e){var o=new Date;r.time=o-g,r.timeInMatch=o-e,g=o,w.recordMove({players:y,gameBoard:c,timestamp:o-e,gameCompleted:m})};$(".game-board").on("click",".cell",function(){var o=$(this),t=+o.data("row-num"),l=+o.data("col-num"),s=(+o.data("player-num"),o.data("is-highest-scoring-move")),u=c.rows[t][l],v=o.data("target"),m=i(),w=_slicedToArray(m,2),d=w[0],g=w[1];if(v){var h=f.setScoreForMove(l,t,d,c),b=h.length;if(0!==b){var C=new Move(t,l,b,d,s);c.moves.push(C),u.player=d,h.forEach(function(r){r.player=d}),S(C,p);var E=e();console.log("Potential Next Moves: ",E);var G=E.sort(function(r,e){return e.pointValue-r.pointValue})[0];G.isHighestScoring=!0,a(g),r(),n(y),f.resetMoveScoreRatings(c),E?console.log("It's now player %d's turn",g):console.log("No next moves for player %d",g)}}}),l(),r(),n(y),console.log("Empty cells: ",f.getEmptyCells(c))}();
//# sourceMappingURL=app.js.map